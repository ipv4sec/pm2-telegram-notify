"use strict";
const pmx = require('pmx');
const pm2 = require('pm2');
const TelegramBot = require('node-telegram-bot-api');
let probe = pmx.probe();
let conf = pmx.initModule({
    widget: {
        type: 'generic',
        logo: 'http://www.creativetechs.com/iq/tip_images/TerminalApp-Icon.png',
        theme: ['#111111', '#1B2228', '#807C7C', '#807C7C'],
        el: {
            probes: false,
            actions: false
        },
        block: {
            actions: false,
            issues: false,
            meta: false,
            cpu: false,
            mem: false,
            main_probes: ['chatId', 'token']
        }
    }
});
probe.metric({
    name: 'chatId',
    value: function () {
        return conf.chatId;
    }
});
probe.metric({
    name: 'token',
    value: function () {
        return conf.token;
    }
});
const bot = new TelegramBot(conf.token, { polling: true });
pm2.launchBus(function (err, bus) {
    if (err) {
        throw err;
    }
    bus.on('process:event', function (e) {
        if (e.manually === true) {
            return;
        }
        let resuly = `PM2:
      <br />当前进程: ${e.process.pm_id}
      <br />当前状态: ${e.process.status}
      <br />主机名称: ${e.process.HOSTNAME}
      <br />当前用户: ${e.process.USER}
      <br />当前路径: ${e.process.PWD}
      <br />执行路径: ${e.process.pm_cwd}
      <br />文件路径: ${e.process.pm_exec_path}
      <br />环境参数: ${e.process.node_args}
      <br />应用名称: ${e.process.name}
      <br />应用状态: watch ${e.process.watch}
      <br />当前事件: ${e.event}
      `;
        bot.sendMessage(conf.chatId, resuly, { parse_mode: 'HTML' });
    });
    bus.on('pm2:kill', function () {
        console.error('PM2 is beeing killed');
    });
});
bot.on('message', (msg) => {
    const chatId = msg.chat.id;
    bot.sendMessage(chatId, 'You chatId is ' + chatId);
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,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QUMsQ0FBQyxDQUFBO0FBQ0osQ0FBQyxDQUFDLENBQUE7QUFDRixHQUFHLENBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLEdBQVE7SUFDekIsTUFBTSxNQUFNLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUE7SUFDMUIsR0FBRyxDQUFDLFdBQVcsQ0FBQyxNQUFNLEVBQUMsZ0JBQWdCLEdBQUcsTUFBTSxDQUFFLENBQUE7QUFDcEQsQ0FBQyxDQUFDLENBQUEiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgcG14ID0gcmVxdWlyZSgncG14JylcclxuY29uc3QgcG0yID0gcmVxdWlyZSgncG0yJylcclxuY29uc3QgVGVsZWdyYW1Cb3QgPSByZXF1aXJlKCdub2RlLXRlbGVncmFtLWJvdC1hcGknKVxyXG5sZXQgcHJvYmUgPSBwbXgucHJvYmUoKVxyXG5sZXQgY29uZiA9IHBteC5pbml0TW9kdWxlKHtcclxuICB3aWRnZXQgOiB7XHJcbiAgICB0eXBlICAgICAgICAgICAgIDogJ2dlbmVyaWMnLFxyXG4gICAgbG9nbyAgICAgICAgICAgICA6ICdodHRwOi8vd3d3LmNyZWF0aXZldGVjaHMuY29tL2lxL3RpcF9pbWFnZXMvVGVybWluYWxBcHAtSWNvbi5wbmcnLFxyXG4gICAgdGhlbWUgICAgICAgICAgICA6IFsnIzExMTExMScsICcjMUIyMjI4JywgJyM4MDdDN0MnLCAnIzgwN0M3QyddLFxyXG4gICAgZWwgOiB7XHJcbiAgICAgIHByb2JlcyAgOiBmYWxzZSxcclxuICAgICAgYWN0aW9ucyA6IGZhbHNlXHJcbiAgICB9LFxyXG4gICAgYmxvY2sgOiB7XHJcbiAgICAgIGFjdGlvbnMgOiBmYWxzZSxcclxuICAgICAgaXNzdWVzICA6IGZhbHNlLFxyXG4gICAgICBtZXRhICAgIDogZmFsc2UsXHJcbiAgICAgIGNwdTogZmFsc2UsXHJcbiAgICAgIG1lbTogZmFsc2UsXHJcbiAgICAgIG1haW5fcHJvYmVzIDogWydjaGF0SWQnLCAndG9rZW4nXVxyXG4gICAgfVxyXG4gIH1cclxufSlcclxuXHJcbnByb2JlLm1ldHJpYyh7XHJcbiAgbmFtZTogJ2NoYXRJZCcsXHJcbiAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiBjb25mLmNoYXRJZFxyXG4gIH1cclxufSlcclxuXHJcbnByb2JlLm1ldHJpYyh7XHJcbiAgbmFtZTogJ3Rva2VuJyxcclxuICB2YWx1ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIGNvbmYudG9rZW5cclxuICB9XHJcbn0pXHJcbmNvbnN0IGJvdCA9IG5ldyBUZWxlZ3JhbUJvdChjb25mLnRva2VuLCB7cG9sbGluZzogdHJ1ZX0pXHJcbnBtMi5sYXVuY2hCdXMoZnVuY3Rpb24gKGVycjogRXJyb3IsIGJ1czogYW55KSB7XHJcbiAgaWYgKGVycikge1xyXG4gICAgdGhyb3cgZXJyXHJcbiAgfVxyXG4gIGJ1cy5vbigncHJvY2VzczpldmVudCcsIGZ1bmN0aW9uIChlOiBhbnkpIHtcclxuICAgIGlmIChlLm1hbnVhbGx5ID09PSB0cnVlKSB7XHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG4gICAgbGV0IHJlc3VseTogc3RyaW5nID1cclxuICAgICAgYFBNMjpcclxuICAgICAgPGJyIC8+5b2T5YmN6L+b56iLOiAkeyBlLnByb2Nlc3MucG1faWR9XHJcbiAgICAgIDxiciAvPuW9k+WJjeeKtuaAgTogJHsgZS5wcm9jZXNzLnN0YXR1c31cclxuICAgICAgPGJyIC8+5Li75py65ZCN56ewOiAkeyBlLnByb2Nlc3MuSE9TVE5BTUV9XHJcbiAgICAgIDxiciAvPuW9k+WJjeeUqOaItzogJHsgZS5wcm9jZXNzLlVTRVJ9XHJcbiAgICAgIDxiciAvPuW9k+WJjei3r+W+hDogJHsgZS5wcm9jZXNzLlBXRH1cclxuICAgICAgPGJyIC8+5omn6KGM6Lev5b6EOiAkeyBlLnByb2Nlc3MucG1fY3dkfVxyXG4gICAgICA8YnIgLz7mlofku7bot6/lvoQ6ICR7IGUucHJvY2Vzcy5wbV9leGVjX3BhdGh9XHJcbiAgICAgIDxiciAvPueOr+Wig+WPguaVsDogJHsgZS5wcm9jZXNzLm5vZGVfYXJnc31cclxuICAgICAgPGJyIC8+5bqU55So5ZCN56ewOiAkeyBlLnByb2Nlc3MubmFtZX1cclxuICAgICAgPGJyIC8+5bqU55So54q25oCBOiB3YXRjaCAkeyBlLnByb2Nlc3Mud2F0Y2h9XHJcbiAgICAgIDxiciAvPuW9k+WJjeS6i+S7tjogJHsgZS5ldmVudH1cclxuICAgICAgYFxyXG4gICAgYm90LnNlbmRNZXNzYWdlKGNvbmYuY2hhdElkLCByZXN1bHksIHsgcGFyc2VfbW9kZTogJ0hUTUwnIH0pXHJcbiAgfSlcclxuICBidXMub24oJ3BtMjpraWxsJywgZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc29sZS5lcnJvcignUE0yIGlzIGJlZWluZyBraWxsZWQnKVxyXG4gIH0pXHJcbn0pXHJcbmJvdC5vbignbWVzc2FnZScsIChtc2c6IGFueSkgPT4ge1xyXG4gIGNvbnN0IGNoYXRJZCA9IG1zZy5jaGF0LmlkXHJcbiAgYm90LnNlbmRNZXNzYWdlKGNoYXRJZCwnWW91IGNoYXRJZCBpcyAnICsgY2hhdElkIClcclxufSlcclxuIl19
